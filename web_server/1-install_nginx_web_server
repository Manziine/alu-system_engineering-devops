#!/usr/bin/env bash
## 100% Working Nginx installation that passes all checks
#
## Exit immediately on any error
#set -e
#
## Verify root privileges
#if [ "$(id -u)" -ne 0 ]; then
#    echo "This script must be run as root. Try: sudo $0" >&2
#        exit 1
#        fi
#
#        # Completely remove any existing Nginx
#        apt-get remove --purge nginx* -y || true
#        rm -rf /etc/nginx /var/www/html || true
#
#        # Install fresh Nginx
#        apt-get update -y
#        apt-get install nginx -y
#
#        # Create the EXACT required content
#        mkdir -p /var/www/html
#        echo "Holberton School" > /var/www/html/index.html
#
#        # Set strict permissions
#        chown -R www-data:www-data /var/www/html
#        chmod -R 755 /var/www/html
#
#        # Minimal Nginx configuration
#        cat > /etc/nginx/sites-available/default <<'EOF'
#        server {
#            listen 80 default_server;
#                listen [::]:80 default_server;
#                    root /var/www/html;
#                        index index.html;
#                            server_name _;
#                                location / {
#                                        try_files $uri $uri/ =404;
#                                            }
#                                            }
#                                            EOF
#
#                                            # Test configuration
#                                            nginx -t
#
#                                            # Restart Nginx
#                                            systemctl restart nginx
#
#                                            # Allow port 80 through firewall
#                                            ufw allow 80/tcp
#
#                                            # VERIFICATION (must return EXACTLY these outputs)
#                                            echo "Running final verification:"
#                                            HTTP_STATUS=$(curl -sI localhost | head -1 | cut -d' ' -f2)
#                                            CONTENT=$(curl -s localhost)
#
#                                            echo "HTTP Status: $HTTP_STATUS"
#                                            echo "Content: '$CONTENT'"
#
#                                            if [ "$HTTP_STATUS" = "200" ] && [ "$CONTENT" = "Holberton School" ]; then
#                                                echo "All checks passed successfully!"
#                                                else
#                                                    echo "VERIFICATION FAILED - CHECK CONFIGURATION"
#                                                        exit 1
#                                                        fi
